(window.webpackJsonp=window.webpackJsonp||[]).push([[4],{305:function(e,t,n){var content=n(369);"string"==typeof content&&(content=[[e.i,content,""]]),content.locals&&(e.exports=content.locals);(0,n(37).default)("e91b3ebe",content,!0,{sourceMap:!1})},355:function(e,t){},357:function(e,t){},368:function(e,t,n){"use strict";var r=n(305);n.n(r).a},369:function(e,t,n){(t=n(36)(!1)).push([e.i,".scroll{height:100%;overflow-y:auto;word-wrap:break-word;word-break:break-all}.vertical{-webkit-writing-mode:vertical-rl;-ms-writing-mode:tb-rl;writing-mode:vertical-rl}#app,body,html{height:100%;margin:0}",""]),e.exports=t},435:function(e,t,n){"use strict";n.r(t);n(14),n(15),n(5),n(42),n(31);var r=n(4),l=(n(38),n(161),n(11)),o=n(27),c=n(21),m=n(16),d=n(7),f=n(20),h=n(110),v=n(343),y=n(76),_=n.n(y);function k(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Object(d.a)(e);if(t){var l=Object(d.a)(this).constructor;n=Reflect.construct(r,arguments,l)}else n=r.apply(this,arguments);return Object(m.a)(this,n)}}var w=function(e,t,n,desc){var r,l=arguments.length,o=l<3?t:null===desc?desc=Object.getOwnPropertyDescriptor(t,n):desc;if("object"===("undefined"==typeof Reflect?"undefined":Object(f.a)(Reflect))&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,n,desc);else for(var i=e.length-1;i>=0;i--)(r=e[i])&&(o=(l<3?r(o):l>3?r(t,n,o):r(t,n))||o);return l>3&&o&&Object.defineProperty(t,n,o),o},x=function(e){Object(c.a)(n,e);var t=k(n);function n(){return Object(l.a)(this,n),t.apply(this,arguments)}return Object(o.a)(n,[{key:"style",value:function(e){var t="0,0,255";return"persName"===e||"rs"===e?t="0,255,0":"placeName"===e?t="255,0,0":"date"===e?t="255,165,0":"bibl"===e&&(t="128,0,128"),"background-color2 : rgba("+t+", 0.2);"}},{key:"mouseover",value:function(e){this.$store.commit("setLineId",e)}},{key:"selectSub",value:function(e){this.$store.commit("setSubLineId",e)}},{key:"editBtnClick",value:function(e){this.$store.commit("setDialogFlag",!0),this.$store.commit("setDialogData",e)}},{key:"anchorClick",value:function(e){this.$store.commit("setMainLineId",e)}},{key:"childDiv",value:function(e){return e.elements[0].attributes?"div"===e.elements[0].attributes.rendition?"div":"span":null}},{key:"getAnchorId",value:function(e){var t=e.attributes.corresp.split("#");return 2===t.length?t[1]:1===t.length?t[0]:null}},{key:"selectManifest",value:function(e){this.$store.commit("setSelectedObj",e)}},{key:"lineId",get:function(){return this.$store.state.lineId}},{key:"subLineId",get:function(){return this.$store.state.subLineId}}]),n}(h.Vue);w([Object(h.Prop)()],x.prototype,"parent",void 0),w([Object(h.Prop)()],x.prototype,"elements",void 0);var S=x=w([Object(h.Component)({components:{}})],x),j=n(50),O=n(121),I=n.n(O),R=n(316),C=n(293),L=n(432),component=Object(j.a)(S,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("span",[e._l(e.elements,(function(t,r){return[t.text?[n("span",{key:r},[e._v(e._s(t.text))])]:"p"===t.name||"head"===t.name||"ab"===t.name||"list"===t.name||"listPerson"===t.name||"item"===t.name||"person"===t.name?[n("span",{key:r,staticClass:"my-5",class:"tei-"+t.name},[t.elements?n("Hello",{key:r,attrs:{elements:t.elements,parent:t.name}}):e._e()],1)]:"date"===t.name?[n("v-tooltip",{key:r,attrs:{bottom:""},scopedSlots:e._u([{key:"activator",fn:function(l){var o=l.on;return[n("span",e._g({style:e.style(t.name)},o),[t.elements?n("Hello",{key:r,attrs:{elements:t.elements,parent:t.name}}):e._e()],1)]}}],null,!0)},[e._v(" "),n("span",[e._v(e._s(t.attributes))])])]:"teiHeader"===t.name?[n("v-sheet",{key:r,staticClass:"pa-5 ma-5",attrs:{color:"grey lighten-3"}},[n("small",[t.elements?n("Hello",{key:r,attrs:{elements:t.elements,parent:t.name}}):e._e()],1)])]:"title"===t.name?[n("h2",{key:r,staticClass:"my-5"},[t.elements?n("Hello",{key:r,attrs:{elements:t.elements,parent:t.name}}):e._e()],1)]:"eaj:ruby"===t.name||t.attributes&&"ruby"===t.attributes.type?[n("ruby",{key:r},[n("Hello",{attrs:{elements:t.elements[0].elements}}),e._v(" "),n("rt",[e._v(e._s(t.elements[2].elements[0].text))])],1)]:"persName"===t.name||"placeName"===t.name||"name"===t.name||"rs"===t.name||"speaker"===t.name||"bibl"===t.name?[n("v-tooltip",{key:r,attrs:{bottom:""},scopedSlots:e._u([{key:"activator",fn:function(l){var o=l.on;return[n("span",e._g({key:r,class:"tei-"+t.name,style:"person"!=e.parent&&"respStmt"!=e.parent?e.style(t.name):"margin-right : 10px; margin-left : 10px;",attrs:{id:t.id}},t.attributes?o:null),[t.elements?n("Hello",{key:r,attrs:{elements:t.elements,parent:t.name}}):e._e()],1)]}}],null,!0)},[e._v(" "),n("span",[e._v(e._s(t.attributes))])])]:"seg"===t.name&&t.attributes&&t.attributes.rendition?[n("span",{key:r,class:"tei-"+t.attributes.rendition,style:t.attributes.style},[t.elements?n("Hello",{key:r,attrs:{elements:t.elements,parent:t.name}}):e._e()],1)]:"anchor"===t.name?[n("span",{key:r,style:e.getAnchorId(t)===e.lineId?"background-color : rgba(255,165,0, 0.5);":"",attrs:{id:"anchor-"+e.getAnchorId(t),dark:""},on:{click:function(n){e.anchorClick(e.getAnchorId(t))},mouseover:function(n){e.mouseover(e.getAnchorId(t))}}},[n("v-icon",{attrs:{"x-small":"",color:"blue darken-2"}},[e._v("mdi-anchor")])],1)]:"seg"===t.name&&t.attributes.corresp?[n("span",{key:r},[n("span",{class:"tei-"+t.name},[t.elements?n("Hello",{key:r,attrs:{elements:t.elements,parent:t.name}}):e._e()],1)])]:"s"===t.name?[n("div"===e.childDiv(t)?"div":"span",{key:r,tag:"component",style:t.attributes["xml:id"]===e.lineId?"background-color : rgba(255,165,0, 0.5);":"",on:{mouseover:function(n){return e.mouseover(t.attributes["xml:id"])},click:function(n){return e.selectSub(t.attributes["xml:id"])}}},[n("span",{class:"tei-"+t.name},[t.elements?n("Hello",{key:r,attrs:{id:"line-"+t.attributes["xml:id"],elements:t.elements,parent:t.name}}):e._e()],1)])]:"figure"!=t.name?[n("span",{key:r,class:"tei-"+t.name},[t.attributes&&t.attributes.facs&&t.attributes.facs.startsWith("#")?n("span",{on:{click:function(n){return e.selectManifest(t)}}},[n("img",{staticClass:"mr-2",staticStyle:{width:"30px"},attrs:{src:"https://iiif.dl.itc.u-tokyo.ac.jp/images/iiif.png"}})]):e._e(),e._v(" "),t.elements?n("Hello",{key:r,attrs:{elements:t.elements,parent:t.name}}):e._e()],1)]:e._e()]}))],2)}),[],!1,null,null,null),M=component.exports;function $(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Object(d.a)(e);if(t){var l=Object(d.a)(this).constructor;n=Reflect.construct(r,arguments,l)}else n=r.apply(this,arguments);return Object(m.a)(this,n)}}I()(component,{VIcon:R.a,VSheet:C.a,VTooltip:L.a});var V=function(e,t,n,desc){var r,l=arguments.length,o=l<3?t:null===desc?desc=Object.getOwnPropertyDescriptor(t,n):desc;if("object"===("undefined"==typeof Reflect?"undefined":Object(f.a)(Reflect))&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,n,desc);else for(var i=e.length-1;i>=0;i--)(r=e[i])&&(o=(l<3?r(o):l>3?r(t,n,o):r(t,n))||o);return l>3&&o&&Object.defineProperty(t,n,o),o},P=n(350),H=n(367);h.Vue.use(H);var D=function(e){Object(c.a)(h,e);var t,n,m,d,f=$(h);function h(){var e;return Object(l.a)(this,h),(e=f.apply(this,arguments)).miradorPrefix="https://nakamura196.github.io/parallel_text_viewer/mirador/",e.width=window.innerWidth,e.height=window.innerHeight,e.returnUrl=null,e.returnLabel=null,e.dialogInformation=!1,e.dialogSettings=!1,e.urlMain="",e.urlSub="",e.dataMain=null,e.dataSub=null,e.imageMap={},e.labelMain="",e.labelSub="",e.selectedManifests=[],e.miradorPath="",e.direction="vertical",e.layout="1x1",e}return Object(o.a)(h,[{key:"watchMainLineId",value:function(){this.scroll("line-"+this.mainLineId,"sub")}},{key:"watchSubLineId",value:function(){this.scroll("anchor-"+this.subLineId,"main")}},{key:"watchSelectedObj",value:function(){for(var e=Number(this.selectedObj.attributes.n),t=this.selectedManifests,n=[],i=0;i<t.length;i++){var r=t[i];if(r.selected){var l=r.label,o=this.imageMap[l].data;if(o[e]){var c=o[e],m=c.split("#xywh="),canvas=m[0],d=m[1].split(","),f=Number(d[1])-150,h=Number(d[3])+150;c=canvas+"#xywh="+d[0]+","+f+","+d[2]+","+h,n.push({manifest:this.imageMap[l].manifest,canvas:c})}}}this.miradorPath=this.miradorPrefix+"?params="+encodeURIComponent(JSON.stringify(n))+"&annotationState=on&layout="+this.layout}},{key:"created",value:(d=Object(r.a)(regeneratorRuntime.mark((function e(){var u,t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return window.addEventListener("resize",this.handleResize),null===this.$route.query.u&&"localhost"!==location.hostname&&(location.href="https://github.com/TEI-EAJ/parallel_text_viewer/"),u=this.$route.query.u,e.next=5,_.a.get(u).then((function(e){return e.data}));case 5:t=e.sent,this.returnUrl=t.returnUrl,this.returnLabel=t.returnLabel,this.direction=t.direction,t.layout&&(this.layout=t.layout),this.exec2image(t.imageMap),this.exec2main(t.urlMain),this.exec2sub(t.urlSub);case 13:case"end":return e.stop()}}),e,this)}))),function(){return d.apply(this,arguments)})},{key:"exec2image",value:(m=Object(r.a)(regeneratorRuntime.mark((function e(t){var n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=this,e.next=3,_.a.get(t).then((function(e){var t=[],r={},l=e.data.selections,o=l.length;if(1===o)n.layout="1x1";else{var col=Math.ceil(o/2);n.layout="2x"+col}for(var i=0;i<l.length;i++){var c=l[i],m=c.members;if(0!==m.length){var d=c.within,f=d.label,h=d["@id"];r[f]={manifest:h,data:{}},t.push({manifest:h}),n.selectedManifests.push({label:f,selected:!0});for(var v=0;v<m.length;v++){var y=m[v],_=void 0;_=y.label?Number(y.label.split("p.")[1]):v+1,r[f].data[_]=y["@id"]}}}n.imageMap=r,n.miradorPath=n.miradorPrefix+"?params="+encodeURIComponent(JSON.stringify(t))+"&annotationState=on&layout="+n.layout}));case 3:case"end":return e.stop()}}),e,this)}))),function(e){return m.apply(this,arguments)})},{key:"beforeDestroy",value:function(){window.removeEventListener("resize",this.handleResize)}},{key:"scroll",value:function(e,t){if(document.querySelector("#"+e)){var n=document;"vertical"===this.direction?this.$SmoothScroll(n.querySelector("#"+e).getBoundingClientRect().left+n.querySelector("#"+t).scrollLeft-n.querySelector("#"+t).getBoundingClientRect().left-n.querySelector("#"+t).getBoundingClientRect().width/2+n.querySelector("#"+e).getBoundingClientRect().width,.1,null,n.querySelector("#"+t),"x"):this.$SmoothScroll(n.querySelector("#"+e).getBoundingClientRect().top+n.querySelector("#"+t).scrollTop-n.querySelector("#"+t).getBoundingClientRect().top,.1,null,n.querySelector("#"+t),"y")}}},{key:"handleResize",value:function(){this.width=window.innerWidth,this.height=window.innerHeight}},{key:"exec2main",value:(n=Object(r.a)(regeneratorRuntime.mark((function e(t){var n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=this,e.next=3,_.a.get(t).then((function(e){var t=e.data;"string"==typeof t&&(t=(new DOMParser).parseFromString(t,"text/xml"));var r=(new XMLSerializer).serializeToString(t),l=P.xml2json(r,{compact:!1,spaces:4});n.dataMain=JSON.parse(l)}));case 3:case"end":return e.stop()}}),e,this)}))),function(e){return n.apply(this,arguments)})},{key:"exec2sub",value:(t=Object(r.a)(regeneratorRuntime.mark((function e(t){var n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=this,e.next=3,_.a.get(t).then((function(e){var t=e.data;"string"==typeof t&&(t=(new DOMParser).parseFromString(t,"text/xml"));var r=(new XMLSerializer).serializeToString(t),l=P.xml2json(r,{compact:!1,spaces:4});n.dataSub=JSON.parse(l)}));case 3:case"end":return e.stop()}}),e,this)}))),function(e){return t.apply(this,arguments)})},{key:"mainLineId",get:function(){return this.$store.state.mainLineId},set:function(e){this.$store.commit("setMainLineId",e)}},{key:"subLineId",get:function(){return this.$store.state.subLineId},set:function(e){this.$store.commit("setSubLineId",e)}},{key:"selectedObj",get:function(){return this.$store.state.selectedObj},set:function(e){this.$store.commit("setSelectedObj",e)}}]),h}(h.Vue);V([Object(h.Watch)("mainLineId")],D.prototype,"watchMainLineId",null),V([Object(h.Watch)("subLineId")],D.prototype,"watchSubLineId",null),V([Object(h.Watch)("selectedObj")],D.prototype,"watchSelectedObj",null);var T=D=V([Object(h.Component)({components:{Splitpanes:v.Splitpanes,Pane:v.Pane,Hello:M}})],D),N=(n(368),n(256)),z=n(438),E=n(441),A=n(331),B=n(291),U=n(257),J=n(439),W=n(336),F=n(311),X=n(312),G=n(442),K=n(434),Q=n(437),Y=n(440),Z=n(339),ee=Object(j.a)(T,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("v-app",[n("v-content",[n("v-app-bar",{attrs:{dark:"",flat:""}},[n("v-toolbar-title",[e._v("Parallel Text Viewer with TEI & IIIF")]),e._v(" "),n("v-spacer"),e._v(" "),n("v-btn",{attrs:{icon:""},on:{click:function(t){t.stopPropagation(),e.dialogSettings=!0}}},[n("v-icon",[e._v("mdi-settings")])],1),e._v(" "),n("v-btn",{attrs:{icon:""},on:{click:function(t){t.stopPropagation(),e.dialogInformation=!0}}},[n("v-icon",[e._v("mdi-information")])],1),e._v(" "),n("v-toolbar-items",{directives:[{name:"show",rawName:"v-show",value:e.returnUrl,expression:"returnUrl"}]},[n("v-btn",{attrs:{text:"",href:e.returnUrl}},[e._v(e._s(e.returnLabel))])],1),e._v(" "),n("v-menu",{attrs:{"offset-y":""},scopedSlots:e._u([{key:"activator",fn:function(t){var r=t.on;return[n("v-btn",e._g({attrs:{depressed:"",btn:""}},r),[n("v-icon",{staticClass:"mr-2"},[e._v("mdi-translate")]),e._v(" "),[e._v("\n              "+e._s("ja"==e.$i18n.locale?"日本語":"English")+"\n              "),n("v-icon",{staticClass:"ml-2"},[e._v("mdi-menu-down")])]],2)]}}])},[e._v(" "),n("v-list",[n("v-list-item",{attrs:{to:e.switchLocalePath("ja")}},[n("v-list-item-title",[e._v("日本語")])],1),e._v(" "),n("v-list-item",{attrs:{to:e.switchLocalePath("en")}},[n("v-list-item-title",[e._v("English")])],1)],1)],1)],1),e._v(" "),n("div",{style:"height: "+e.height+"px;"},[n("splitpanes",{staticClass:"default-theme"},[n("pane",{attrs:{"min-size":"20"}},[n("iframe",{staticClass:"py-2 px-2",staticStyle:{border:"none"},attrs:{src:e.miradorPath,seamless:"seamless",width:"100%",height:e.height+"px",allow:"fullscreen"}})]),e._v(" "),n("pane",[n("splitpanes",{staticClass:"default-theme",attrs:{horizontal:"horizontal"}},[n("pane",{staticClass:"py-2 mx-2"},[n("v-card",{staticClass:"scroll vertical",attrs:{id:"main",flat:""}},[e.dataMain?n("Hello",{attrs:{elements:e.dataMain.elements}}):e._e()],1)],1),e._v(" "),n("pane",{staticClass:"py-2 mx-2"},[n("v-card",{staticClass:"scroll vertical",attrs:{id:"sub",flat:""}},[e.dataSub?n("Hello",{attrs:{elements:e.dataSub.elements}}):e._e()],1)],1)],1)],1)],1)],1)],1),e._v(" "),n("v-dialog",{attrs:{width:"600px"},model:{value:e.dialogInformation,callback:function(t){e.dialogInformation=t},expression:"dialogInformation"}},[n("v-card",[n("v-card-title",{staticClass:"headline grey lighten-2",attrs:{"primary-title":""}},[e._v(e._s(e.$t("information")))]),e._v(" "),n("v-card-text",{staticClass:"mt-5"},[n("a",{attrs:{target:"_blank",href:this.$route.query.u}},[e._v(e._s(this.$route.query.u))])]),e._v(" "),n("v-card-actions",[n("v-spacer"),e._v(" "),n("v-btn",{attrs:{color:"secondary"},on:{click:function(t){e.dialogInformation=!1}}},[e._v(e._s(e.$t("close")))])],1)],1)],1),e._v(" "),n("v-dialog",{attrs:{width:"600px"},model:{value:e.dialogSettings,callback:function(t){e.dialogSettings=t},expression:"dialogSettings"}},[n("v-card",[n("v-card-title",{staticClass:"headline grey lighten-2",attrs:{"primary-title":""}},[e._v(e._s(e.$t("settings")))]),e._v(" "),n("v-card-text",{staticClass:"mt-5"},[n("v-text-field",{staticClass:"mb-5",attrs:{label:"Mirador表示レイアウト Ex. 1x1, 2x2, ..."},model:{value:e.layout,callback:function(t){e.layout=t},expression:"layout"}}),e._v(" "),e._l(e.selectedManifests,(function(t,r){return n("v-switch",{key:r,attrs:{label:t.label},model:{value:t.selected,callback:function(n){e.$set(t,"selected",n)},expression:"obj.selected"}})}))],2),e._v(" "),n("v-card-actions",[n("v-spacer"),e._v(" "),n("v-btn",{attrs:{color:"secondary"},on:{click:function(t){e.dialogSettings=!1}}},[e._v(e._s(e.$t("close")))])],1)],1)],1)],1)}),[],!1,null,null,null);t.default=ee.exports;I()(ee,{VApp:N.a,VAppBar:z.a,VBtn:E.a,VCard:A.a,VCardActions:B.a,VCardText:B.b,VCardTitle:B.c,VContent:U.a,VDialog:J.a,VIcon:R.a,VList:W.a,VListItem:F.a,VListItemTitle:X.a,VMenu:G.a,VSpacer:K.a,VSwitch:Q.a,VTextField:Y.a,VToolbarItems:Z.a,VToolbarTitle:Z.b})}}]);